{
  "version": 3,
  "file": "",
  "sourceRoot": "",
  "sources": [
    "../src/checks-mixin.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n\n'use strict'\n\n############################################################################################################\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = 'ICQL-DBA/CHECKS-MIXIN'\ndebug                     = CND.get_logger 'debug',     badge\nwarn                      = CND.get_logger 'warn',      badge\ninfo                      = CND.get_logger 'info',      badge\nurge                      = CND.get_logger 'urge',      badge\nhelp                      = CND.get_logger 'help',      badge\nwhisper                   = CND.get_logger 'whisper',   badge\necho                      = CND.echo.bind CND\n#...........................................................................................................\nPATH                      = require 'path'\nFS                        = require 'fs'\nE                         = require './errors'\n{ misfit }                = require './common'\nSQL                       = String.raw\n\n\n#===========================================================================================================\n# CHECK, GETS, SETS\n#-----------------------------------------------------------------------------------------------------------\n@Checks_mixin = ( clasz = Object ) => class extends clasz\n\n\n  #=========================================================================================================\n  # FOREIGN KEYS MODE, DEFERRED\n  #---------------------------------------------------------------------------------------------------------\n  ### get_foreign_keys_state ###\n  get_foreign_keys_state: -> not not ( @pragma \"foreign_keys;\" )[ 0 ].foreign_keys\n\n  #---------------------------------------------------------------------------------------------------------\n  set_foreign_keys_state: ( onoff ) ->\n    @types.validate.boolean onoff\n    @pragma \"foreign_keys = #{onoff};\"\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  ### TAINT add schema, table_name; currently only works for main(?) ###\n  check_foreign_keys: -> @pragma SQL\"foreign_key_check;\"\n\n  #---------------------------------------------------------------------------------------------------------\n  set_foreign_keys_deferred: ( onoff ) -> @types.validate.boolean onoff; @pragma SQL\"defer_foreign_keys=#{onoff};\"\n  get_foreign_keys_deferred: -> @pragma SQL\"defer_foreign_keys;\"\n\n  #=========================================================================================================\n  # UNSAFE MODE\n  #---------------------------------------------------------------------------------------------------------\n  get_unsafe_mode: -> @_state.in_unsafe_mode\n\n  #---------------------------------------------------------------------------------------------------------\n  set_unsafe_mode: ( onoff ) ->\n    @types.validate.boolean onoff\n    @sqlt.unsafeMode onoff\n    @_state = lets @_state, ( d ) -> d.in_unsafe_mode = onoff\n    return null\n\n\n  #=========================================================================================================\n  # TRANSACTIONS\n  #---------------------------------------------------------------------------------------------------------\n  within_transaction:   -> not not dba.sqlt.inTransaction()\n  begin_transaction:    -> throw new @Dba_not_implemented '^dba/checks@1^', \"tx_begin\"\n  commit_transaction:   -> throw new @Dba_not_implemented '^dba/checks@1^', \"tx_commit\"\n  rollback_transaction: -> throw new @Dba_not_implemented '^dba/checks@1^', \"tx_rollback\"\n\n\n  #=========================================================================================================\n  # INTEGRITY\n  #---------------------------------------------------------------------------------------------------------\n  check_integrity:    -> @pragma SQL\"integrity_check;\"\n  check_quick:        -> @pragma SQL\"quick_check;\"\n\n\n  ### LEGACY ###\n  _get_foreign_keys_state: -> @get_foreign_keys_state()\n  _set_foreign_keys_state: ( onoff ) -> @set_foreign_keys_state onoff\n  _get_unsafe_mode: -> @get_unsafe_mode()\n  _set_unsafe_mode: ( onoff ) -> @set_unsafe_mode onoff\n\n"
  ]
}